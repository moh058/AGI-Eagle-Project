name: AGI-Telegram-Build
on:
  push:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v4
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.9"
      - name: Install Dependencies
        run: |
          pip install buildozer cython==0.29.33 kivy requests
      - name: Build APK
        run: |
          buildozer init
          sed -i 's/requirements = python3,kivy/requirements = python3,kivy,requests/' buildozer.spec
          sed -i 's/# android.accept_sdk_license = False/android.accept_sdk_license = True/' buildozer.spec
          yes | buildozer -v android debug
      - name: Send to Telegram
        run: |
          APK_PATH=$(find bin/ -name "*.apk")
          curl -v -F "chat_id=${{ secrets.CHAT_ID }}" \
               -F "document=@$APK_PATH" \
               -F "caption=ðŸš€ ØªÙ… Ø¨Ù†Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚Ùƒ Ø¨Ù†Ø¬Ø§Ø­!" \
               https://api.telegram.org/bot${{ secrets.BOT_TOKEN }}/sendDocument

